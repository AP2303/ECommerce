<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/css/product.css">
</head>

<body>
    <%- include('../includes/navigation.ejs') %>
    <main>
        <section class="product-detail">
            <div class="product-detail__image">
                <%
                  let imgSrc = product.imageUrl || '/images/placeholder.svg';
                  if (product.imageUrl) {
                    const v = String(product.imageUrl).trim();
                    if (v.indexOf('http') === 0) {
                      imgSrc = '/images/proxy?src=' + encodeURIComponent(v);
                    } else if (v.indexOf('/') === 0) {
                      imgSrc = v;
                    } else {
                      imgSrc = '/images/' + v;
                    }
                  }
                %>
                <img src="<%= imgSrc %>" alt="<%= product.title %>" class="js-img-fallback" data-placeholder="/images/placeholder.svg" width="400" height="560">
            </div>
            <div class="product-detail__info">
                <h1><%= product.title %></h1>
                <h2>$<%= product.price %></h2>
                <p><%= product.description %></p>
                <%- include('../includes/add-to-cart.ejs', { product: product }) %>
            </div>
        </section>
    </main>
    <%- include('../includes/end.ejs') %>
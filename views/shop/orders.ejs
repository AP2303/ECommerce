<%- include('../includes/head.ejs') %>
    </head>

    <body>
        <%- include('../includes/navigation.ejs') %>
        <main class="dashboard-container" style="max-width:1000px;margin:20px auto;padding:20px;">
            <h2>My Orders</h2>
            <% if (orders.length <= 0) { %>
                <div style="color:#999;padding:40px;text-align:center;">You have no orders yet.</div>
            <% } else { %>
                <div style="display:grid;gap:12px;">
                    <% orders.forEach(order => { %>
                        <div style="border:1px solid #eee;padding:12px;border-radius:8px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;">
                              <div>
                                <h3 style="margin:0 0 6px 0;">Order #<%= order.orderNumber || order.id %></h3>
                                <p style="margin:0;color:#666;">Placed: <%= new Date(order.createdAt).toLocaleString() %></p>
                              </div>
                              <div style="text-align:right;">
                                <div style="font-weight:700;">$<%= (order.totalAmount||0).toFixed(2) %></div>
                                <div style="margin-top:6px;color:#666;">Status: <strong><%= order.status %></strong></div>
                              </div>
                            </div>
                            <hr>
                            <div style="display:flex;gap:12px;flex-wrap:wrap;">
                                <% (order.products || []).forEach(product => { %>
                                  <div style="width:140px;border:1px solid #f0f0f0;padding:8px;border-radius:6px;">
                                    <img src="<%= product.imageUrl && product.imageUrl.indexOf('http')===0 ? ('/images/proxy?src=' + encodeURIComponent(product.imageUrl)) : (product.imageUrl || '/images/placeholder.svg') %>" alt="<%= product.title %>" class="js-img-fallback" data-placeholder="/images/placeholder.svg" style="width:100%;height:160px;object-fit:cover;border-radius:4px;">
                                    <div style="font-weight:600;margin-top:6px;"><%= product.title %></div>
                                    <div style="color:#666;font-size:13px;">Qty: <%= product.orderItem.quantity %></div>
                                  </div>
                                <% }) %>
                            </div>
                        </div>
                    <% }); %>
                </div>
            <% } %>
        </main>
        <%- include('../includes/end.ejs') %>